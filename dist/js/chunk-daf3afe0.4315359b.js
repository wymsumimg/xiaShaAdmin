(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-daf3afe0"],{"24e5":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.productS?a("div",{staticClass:"shop"},[a("div",{staticClass:"shop-title"},[t._v("商城配置")]),a("div",{staticStyle:{flex:"1"},attrs:{flex:"dir:top"}},[a("el-tabs",{staticStyle:{flex:"1",margin:"0 40px"},attrs:{flex:"dir:top",value:"second"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{staticClass:"shop-item1",attrs:{label:"banner设置",name:"first"}},[a("div",{staticClass:"shop-item1-title"},[a("el-radio",{attrs:{label:"1"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("智能家具")]),a("el-radio",{attrs:{label:"2"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("宽带业务")])],1),t._l(t.bannerList,function(e,i){return a("div",{staticClass:"shop-item1-add"},[a("div",{staticClass:"shop-item1-addTitle",attrs:{flex:"cross:center"}},[a("span"),a("p",[t._v("banner - 0"+t._s(i+1))])]),a("l-upload",{attrs:{width:"316",height:"136",imgUrl:e.imgUrl,router:"shop",spec:t.spec},on:{"update:imgUrl":function(a){return t.$set(e,"imgUrl",a)},"update:img-url":function(a){return t.$set(e,"imgUrl",a)}}}),a("p",{staticClass:"shop-item1-addTips"},[t._v("建议尺寸：690X390,图片小于≤2M")]),a("div",{staticClass:"shop-item1-addRadio",attrs:{flex:"cross:center"}},[a("span",[t._v("图片链接")]),a("el-radio",{attrs:{label:1},model:{value:e.bannerType,callback:function(a){t.$set(e,"bannerType",a)},expression:"item.bannerType"}},[t._v("产品")]),a("el-radio",{attrs:{label:0},model:{value:e.bannerType,callback:function(a){t.$set(e,"bannerType",a)},expression:"item.bannerType"}},[t._v("无链接")])],1),"1"==e.bannerType?a("div",{staticClass:"shop-item1-addRadio",attrs:{flex:"cross:center"},on:{click:function(a){return t.productActive(e,i)}}},[a("span"),e.productImg?a("div",{staticClass:"shop-item1-addBtn",attrs:{btn:"",flex:"cross:center"}},[a("img",{attrs:{src:e.productImg}}),a("p",[t._v(t._s(e.productName))])]):a("div",{staticClass:"shop-item1-addBtn",attrs:{btn:""}},[t._v("选择产品")])]):t._e(),a("div",{staticClass:"shop-item1-detBtn",attrs:{btn:""},on:{click:function(e){return t.detBanner(i)}}},[t._v("删除")])],1)}),a("div",{staticClass:"shop-item1-btn",attrs:{btn:""},on:{click:t.setBanner}},[t._v("保存")])],2),a("el-tab-pane",{staticClass:"shop-item2",attrs:{label:"小区设置",name:"second"}},[a("div",{staticClass:"shop-item1-addTitle",staticStyle:{"margin-top":"38px"},attrs:{flex:"main:justify cross:center"}},[a("div",{attrs:{flex:"cross:center"}},[a("span"),a("p",[t._v("现有小区（共"+t._s(t.total)+"个）")])]),a("router-link",{staticClass:"shop-item2-title",attrs:{tag:"div",to:{name:"addShop",type:"add"},btn:""}},[t._v("添加小区")])],1),a("div",[a("el-table",{staticStyle:{width:"100%","border-top":"1px solid #F0F0F0","margin-top":"32px"},attrs:{data:t.dataList}},[a("el-table-column",{attrs:{prop:"regionName",label:"小区名称",align:"center","min-width":"130"}}),a("el-table-column",{attrs:{prop:"address",label:"详细地址",align:"center","min-width":"300"}}),a("el-table-column",{attrs:{prop:"salesUserName,salesUserMobile",label:"当前负责业务员",align:"center","min-width":"130"},scopedSlots:t._u([{key:"default",fn:function(e){return t._t("default",[a("p",[t._v(t._s(e.row.salesUserName))]),a("p",[t._v(t._s(e.row.salesUserMobile))])])}}],null,!0)}),a("el-table-column",{attrs:{prop:"wyUserUnit",label:"物业单位",align:"center","min-width":"130"}}),a("el-table-column",{attrs:{prop:"wyUserName,wyUserMobile",label:"小区负责人员",align:"center","min-width":"130"},scopedSlots:t._u([{key:"default",fn:function(e){return t._t("default",[a("p",[t._v(t._s(e.row.wyUserName))]),a("p",[t._v(t._s(e.row.wyUserMobile))])])}}],null,!0)}),a("el-table-column",{attrs:{prop:"wyUserName,wyUserMobile",label:"二维码",align:"center","min-width":"130"},scopedSlots:t._u([{key:"default",fn:function(e){return t._t("default",[a("img",{staticClass:"shop-item2-img",attrs:{src:e.row.qrUrl,id:"images"},on:{click:function(a){return t.clickImg(e.row.qrUrl)}}})])}}],null,!0)}),a("el-table-column",{attrs:{prop:"historyTime",label:"操作",align:"center",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return t._t("default",[a("div",{attrs:{flex:""}},[a("router-link",{staticClass:"shop-item2-edit",attrs:{tag:"div",to:{name:"addShop",query:{item:JSON.stringify(e.row),type:"edit"}},btn:""}},[t._v("编辑")]),a("div",{staticClass:"shop-item2-delete",attrs:{btn:""},on:{click:function(a){return t.delRegion(e.row.id)}}},[t._v("删除")])],1)])}}],null,!0)})],1),a("l-pagination",{attrs:{flex:"main:right",dataList:t.dataList,item:t.dataJson},on:{"update:dataList":function(e){t.dataList=e},"update:data-list":function(e){t.dataList=e},"update:total":t.getTotal}})],1)])],1)],1),a("l-dialog",{attrs:{dialogVisible:t.dialogImg,title:"当前小区业务员名片码",width:"540px"},on:{"update:dialogVisible":function(e){t.dialogImg=e},"update:dialog-visible":function(e){t.dialogImg=e}}},[a("div",{staticClass:"dialogBox"},[a("img",{staticClass:"img",attrs:{src:t.img,id:"images"}}),a("div",{staticClass:"btnBox"},[a("div",{class:["btn",t.img?"save-btn":"gray-btn"],staticStyle:{"margin-right":"16px"},attrs:{btn:""},on:{click:t.save}},[t._v("保存并下载")]),a("div",{staticClass:"btn cancel-btn",attrs:{btn:""},on:{click:t.cancel}},[t._v("取消")])])])])],1):a("div",{staticStyle:{padding:"0"}},[a("l-product",{attrs:{activeId:t.activeData.productId},on:{upActive:t.upActive}})],1)},n=[],s=a("f499"),r=a.n(s),o={components:{},data:function(){return{spec:{width:690,height:390,size:2048},dataList:[],productS:!0,activeName:"first",activeData:{},type:"1",dialogVisible:!1,dialogImg:!1,img:"",bannerList:[],bannerData:{},dialog:{title:"选择产品",width:"636px",center:!1},total:0,listShow:!1}},watch:{type:function(t){for(var e="1"==t?this.bannerData.furnishing:this.bannerData.broadband,a=0;a<3;a++)e[a]||e.push({imgUrl:"",bannerType:0,productId:""});this.bannerList=e},bannerList:{handler:function(t){},immediate:!0,deep:!0}},computed:{dataJson:function(){return{url:this.$apis.shop.list,listShow:this.listShow}}},created:function(){this.$route.matched[1].query="house",this.activeName="house"==this.$route.query.type?"second":"first",this.banner()},methods:{clickImg:function(t){this.img=t,this.dialogImg=!0},save:function(){if(this.img){var t=new Image;t.setAttribute("crossOrigin","anonymous"),t.onload=function(){var e=document.createElement("canvas");e.width=t.width,e.height=t.height;var a=e.getContext("2d");a.drawImage(t,0,0,t.width,t.height);var i=e.toDataURL("image/png"),n=document.createElement("a"),s=new MouseEvent("click");n.download=name||"二维码",n.href=i,n.dispatchEvent(s)},t.src=document.getElementById("images").src}},cancel:function(){this.dialogImg=!1},detBanner:function(t){this.$set(this.bannerList,t,{imgUrl:"",bannerType:0,productId:""})},delRegion:function(t){var e=this;this.$confirm("您确定要删除该小区吗？（删除后不可恢复）","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.get(e.$apis.shop.delRegion,{params:{id:t}}).then(function(t){"200"==t.code&&(e.listShow=!e.listShow),e.$toast(t.msg),e.banner()})}).catch(function(){})},getTotal:function(t){this.total=t},productActive:function(t,e){t.key=e,this.activeData=t,this.productS=!1},upActive:function(t){var e=JSON.parse(r()(this.bannerList)),a=this.activeData.key;e[a].productId=t.id,e[a].productImg=t.productImg,e[a].productName=t.productName,this.bannerList=e,this.productS=!0},setBanner:function(){var t=this;for(var e in this.bannerList)if("1"==this.bannerList[e].bannerType&&(!this.bannerList[e].productId||""==this.bannerList[e].productId))return void this.$toast("请选择产品");var a=JSON.parse(r()(this.bannerList));a=a.filter(function(t){return""!=t.imgUrl}),0!=a.length?this.$http.post(this.$apis.shop.setBanner,{type:this.type,bannerList:a}).then(function(e){"200"==e.code&&t.banner(),t.$toast(e.msg)}):this.$toast("请至少上传一个banner")},banner:function(){var t=this;this.$http.get(this.$apis.shop.banner).then(function(e){if("200"==e.code){if(3==e.data.furnishing.length)t.bannerList="1"==t.type?e.data.furnishing:e.data.broadband;else{for(var a="1"==t.type?e.data.furnishing:e.data.broadband,i=0;i<3;i++)a[i]||a.push({imgUrl:"",bannerType:0,productId:""});t.bannerList=a}t.bannerData=e.data}})}}},l=o,c=(a("79f7"),a("2877")),d=Object(c["a"])(l,i,n,!1,null,"59a65d9a",null);e["default"]=d.exports},4066:function(t,e,a){},"79f7":function(t,e,a){"use strict";var i=a("4066"),n=a.n(i);n.a},a21f:function(t,e,a){var i=a("584a"),n=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},f499:function(t,e,a){t.exports=a("a21f")}}]);